import {
  AggregateFunctionType,
  BaseConfigurationTypes,
  Group,
  Measure,
  MeasureScoring,
  Model,
  PopulationExpectedValue,
  PopulationType,
  TestCase,
} from "@madie/madie-models";
import { CqmExecutionPatientResultsByPopulationSet } from "../QdmCalculationService";
import { ExecutionStatusType } from "../CalculationService";

export interface QdmTestCaseProcessingScenario {
  testCase: TestCase;
  measureGroups: Group[];
  measure: Measure;
  patientResults: CqmExecutionPatientResultsByPopulationSet;
}

export const CV_PATIENT_WITH_OBS_RESULTS: QdmTestCaseProcessingScenario = {
  testCase: {
    id: "6595f2484fc1aa5fa9481b39",
    name: null,
    title: "AllPass",
    series: "",
    description: "",
    createdAt: "2024-01-03T23:48:24.733Z",
    createdBy: "John.doe@semanticbits.com",
    lastModifiedAt: "2024-01-08T15:23:13.308891Z",
    lastModifiedBy: "John.doe@semanticbits.com",
    validResource: true,
    json: "",
    patientId: "c519b55c-489f-43e9-b734-1089006badd2",
    hapiOperationOutcome: null,
    groupPopulations: [
      {
        groupId: "6598592b4fc1aa5fa9481b6c",
        scoring: "Continuous Variable",
        populationBasis: "true",
        populationValues: [
          {
            id: "a1978460-ef2e-44ea-9d00-5f44d42d721a",
            criteriaReference: null,
            name: PopulationType.INITIAL_POPULATION,
            expected: true,
            actual: null,
          },
          {
            id: "1051cf7f-cbc3-4163-9f7f-046d614c53ad",
            criteriaReference: null,
            name: PopulationType.MEASURE_POPULATION,
            expected: true,
            actual: null,
          },
          {
            id: "d73016eb-6757-4a32-804b-2e3b5d5852e7",
            criteriaReference: null,
            name: PopulationType.MEASURE_POPULATION_EXCLUSION,
            expected: true,
            actual: null,
          },
        ],
        stratificationValues: [
          {
            id: "10273589-4465-4048-8135-5e9e8e4f5e31",
            name: "Strata-1",
            expected: true,
            actual: null,
            populationValues: [
              {
                id: "a1978460-ef2e-44ea-9d00-5f44d42d721a",
                criteriaReference: null,
                name: PopulationType.INITIAL_POPULATION,
                expected: true,
                actual: null,
              },
              {
                id: "1051cf7f-cbc3-4163-9f7f-046d614c53ad",
                criteriaReference: null,
                name: PopulationType.MEASURE_POPULATION,
                expected: true,
                actual: null,
              },
              {
                id: "d73016eb-6757-4a32-804b-2e3b5d5852e7",
                criteriaReference: null,
                name: PopulationType.MEASURE_POPULATION_EXCLUSION,
                expected: true,
                actual: null,
              },
            ],
          },
        ],
      },
      {
        groupId: "659859374fc1aa5fa9481b6d",
        scoring: "Continuous Variable",
        populationBasis: "true",
        populationValues: [
          {
            id: "d380f8f8-ac6d-420e-bfed-39ca3b061955",
            criteriaReference: null,
            name: PopulationType.INITIAL_POPULATION,
            expected: true,
            actual: null,
          },
          {
            id: "9420c279-c6a8-45c9-9d74-e6651e542518",
            criteriaReference: null,
            name: PopulationType.MEASURE_POPULATION,
            expected: true,
            actual: null,
          },
          {
            id: "measurePopulationObservation0",
            criteriaReference: "9420c279-c6a8-45c9-9d74-e6651e542518",
            name: PopulationType.MEASURE_POPULATION_OBSERVATION,
            expected: 60,
            actual: null,
          },
        ],
        stratificationValues: [
          {
            id: "15d7526f-d8d3-4f10-98fb-1ebbd0522853",
            name: "Strata-1",
            expected: null,
            actual: null,
            populationValues: [
              {
                id: "d380f8f8-ac6d-420e-bfed-39ca3b061955",
                criteriaReference: null,
                name: PopulationType.INITIAL_POPULATION,
                expected: false,
                actual: null,
              },
              {
                id: "9420c279-c6a8-45c9-9d74-e6651e542518",
                criteriaReference: null,
                name: PopulationType.MEASURE_POPULATION,
                expected: false,
                actual: null,
              },
              {
                id: "measurePopulationObservation0",
                criteriaReference: "9420c279-c6a8-45c9-9d74-e6651e542518",
                name: PopulationType.MEASURE_POPULATION_OBSERVATION,
                expected: null,
                actual: null,
              },
            ],
          },
        ],
      },
    ],
    executionStatus: "pass",
  },
  measureGroups: [
    {
      id: "6598592b4fc1aa5fa9481b6c",
      scoring: "Continuous Variable",
      populations: [
        {
          id: "a1978460-ef2e-44ea-9d00-5f44d42d721a",
          name: PopulationType.INITIAL_POPULATION,
          definition: "Initial Population",
          associationType: null,
          description: "",
        },
        {
          id: "1051cf7f-cbc3-4163-9f7f-046d614c53ad",
          name: PopulationType.MEASURE_POPULATION,
          definition: "Measure Population",
          associationType: null,
          description: "",
        },
        {
          id: "d73016eb-6757-4a32-804b-2e3b5d5852e7",
          name: PopulationType.MEASURE_POPULATION_EXCLUSION,
          definition: "Measure Population Exclusion",
          associationType: null,
          description: "",
        },
      ],
      measureObservations: [
        {
          id: "12f78f0b-ea73-4de3-8fd3-3ca92d2350dc",
          definition: "Measure Observation hours",
          description: null,
          criteriaReference: "1051cf7f-cbc3-4163-9f7f-046d614c53ad",
          aggregateMethod: AggregateFunctionType.COUNT,
        },
      ],
      groupDescription: "",
      improvementNotation: "",
      rateAggregation: "",
      measureGroupTypes: null,
      scoringUnit: "",
      stratifications: [
        {
          id: "10273589-4465-4048-8135-5e9e8e4f5e31",
          description: "",
          cqlDefinition: "Strat1",
          association: null,
        },
      ],
      populationBasis: "true",
    },
    {
      id: "659859374fc1aa5fa9481b6d",
      scoring: "Continuous Variable",
      populations: [
        {
          id: "d380f8f8-ac6d-420e-bfed-39ca3b061955",
          name: PopulationType.INITIAL_POPULATION,
          definition: "Initial Population",
          associationType: null,
          description: "",
        },
        {
          id: "9420c279-c6a8-45c9-9d74-e6651e542518",
          name: PopulationType.MEASURE_POPULATION,
          definition: "Measure Population",
          associationType: null,
          description: "",
        },
        {
          id: "f029236c-72ff-4a29-909f-13514302d5de",
          name: PopulationType.MEASURE_POPULATION_EXCLUSION,
          definition: "",
          associationType: null,
          description: "",
        },
      ],
      measureObservations: [
        {
          id: "12f78f0b-ea73-4de3-8fd3-3ca92d2350dc",
          definition: "Measure Observation minutes",
          description: null,
          criteriaReference: "9420c279-c6a8-45c9-9d74-e6651e542518",
          aggregateMethod: AggregateFunctionType.COUNT,
        },
      ],
      groupDescription: "",
      improvementNotation: "",
      rateAggregation: "",
      measureGroupTypes: null,
      scoringUnit: "",
      stratifications: [
        {
          id: "15d7526f-d8d3-4f10-98fb-1ebbd0522853",
          description: "",
          cqlDefinition: "Strat2",
          association: null,
        },
      ],
      populationBasis: "true",
    },
  ],
  measure: {
    id: "6525ae204a75bf514e67c8d3",
    cqlLibraryName: "QdmCvPatient2",
    measureName: "QdmCvPatient2",
    active: true,
    cqlErrors: false,
    errors: [],
    cql: "",
    elmJson: "",
    testCases: [],
    groups: [],
    measurementPeriodStart: new Date("2024-01-01T00:00:00.000+00:00"),
    measurementPeriodEnd: new Date("2024-12-31T23:59:59.999+00:00"),
    model: Model.QDM_5_6,
    scoring: "Continuous Variable",
    baseConfigurationTypes: [BaseConfigurationTypes.OUTCOME],
    patientBasis: true,
  } as unknown as Measure,
  patientResults: {
    "6598592b4fc1aa5fa9481b6c": {
      IPP: 1,
      MSRPOPL: 1,
      MSRPOPLEX: 1,
      observation_values: [],
      clause_results: null,
      patient: "6595f24a85fe0f0000f141e9",
      measure: "659c1c22b5c6be00005c92a5",
      state: "complete",
    },
    "659859374fc1aa5fa9481b6d": {
      IPP: 1,
      MSRPOPL: 1,
      MSRPOPLEX: 0,
      observation_values: [null, 60],
      clause_results: null,
      patient: "6595f24a85fe0f0000f141e9",
      measure: "659c1c22b5c6be00005c92a5",
      state: "complete",
    },
    PopulationSet_1_Stratification_1: {
      IPP: 1,
      MSRPOPL: 1,
      MSRPOPLEX: 1,
      STRAT: 1,
      observation_values: [],
      clause_results: null,
      patient: "6595f24a85fe0f0000f141e9",
      measure: "659c1c22b5c6be00005c92a5",
      state: "complete",
    },
    PopulationSet_2_Stratification_1: {
      IPP: 0,
      MSRPOPL: 0,
      MSRPOPLEX: 0,
      STRAT: 0,
      observation_values: [],
      clause_results: null,
      patient: "6595f24a85fe0f0000f141e9",
      measure: "659c1c22b5c6be00005c92a5",
      state: "complete",
    },
  },
};

export const CV_EPISODE_WITH_STRAT_OBS_RESULTS: QdmTestCaseProcessingScenario =
  {
    measure: {
      id: "65805a4603b4536f971d2e88",
      measureHumanReadableId: null,
      measureSetId: "6fdd284b-5bd7-4918-bc14-73f7d148844b",
      version: "0.0.000",
      revisionNumber: null,
      state: null,
      cqlLibraryName:
        "MedianAdmitDecisionTimetoEDDepartureTimeforAdmittedPatients",
      ecqmTitle: "CMS111",
      measureName:
        "Median Admit Decision Time to ED Departure Time for Admitted Patients",
      active: true,
      cqlErrors: false,
      errors: [],
      cql: "",
      elmJson: null,
      elmXml: null,
      groups: [],
      testCase: [],
      createdAt: "2023-12-18T14:42:14.880Z",
      createdBy: "john_doe.@semanticbits.com",
      lastModifiedAt: "2024-01-02T20:34:17.305Z",
      lastModifiedBy: "john_doe@semanticbits.com",
      measurementPeriodStart: "2025-01-01T00:00:00.000+00:00",
      measurementPeriodEnd: "2025-12-31T23:59:59.999+00:00",
      model: "QDM v5.6",
      scoring: "Continuous Variable",
      baseConfigurationTypes: ["Appropriate Use Process"],
      patientBasis: false,
    } as unknown as Measure,
    testCase: {
      id: "659c25a94fc1aa5fa9481b71",
      name: null,
      title: "TC1",
      series: "",
      description: "",
      createdAt: "2024-01-08T16:41:13.995Z",
      createdBy: "John.doe@semanticbits.com",
      lastModifiedAt: "2024-01-08T17:19:15.766470Z",
      lastModifiedBy: "John.doe@semanticbits.com",
      validResource: true,
      json: "{}",
      patientId: "9725b9af-6f64-472f-ab52-9805c7c26394",
      hapiOperationOutcome: null,
      groupPopulations: [
        {
          groupId: "659c25644fc1aa5fa9481b70",
          scoring: "Continuous Variable",
          populationBasis: "false",
          populationValues: [
            {
              id: "cd01718c-a249-47b9-8dea-e6d828bc84c6",
              criteriaReference: null,
              name: PopulationType.INITIAL_POPULATION,
              expected: 3,
              actual: null,
            },
            {
              id: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
              criteriaReference: null,
              name: PopulationType.MEASURE_POPULATION,
              expected: 3,
              actual: null,
            },
            {
              id: "6165a87f-4142-4cb6-83de-924772ab9260",
              criteriaReference: null,
              name: PopulationType.MEASURE_POPULATION_EXCLUSION,
              expected: 1,
              actual: null,
            },
            {
              id: "measurePopulationObservation0",
              criteriaReference: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
              name: PopulationType.MEASURE_POPULATION_OBSERVATION,
              expected: 8,
              actual: null,
            },
            {
              id: "measurePopulationObservation1",
              criteriaReference: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
              name: PopulationType.MEASURE_POPULATION_OBSERVATION,
              expected: 6,
              actual: null,
            },
          ],
          stratificationValues: [
            {
              id: "bfd47335-3d0c-4234-8bab-14ab8504ec92",
              name: "Strata-1",
              expected: 1,
              actual: null,
              populationValues: [
                {
                  id: "cd01718c-a249-47b9-8dea-e6d828bc84c6",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "6165a87f-4142-4cb6-83de-924772ab9260",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION_EXCLUSION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "measurePopulationObservation0",
                  criteriaReference: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
                  name: PopulationType.MEASURE_POPULATION_OBSERVATION,
                  expected: 8,
                  actual: null,
                },
              ],
            },
            {
              id: "79a18154-74ce-4fc5-af2e-82b167dc5685",
              name: "Strata-2",
              expected: 1,
              actual: null,
              populationValues: [
                {
                  id: "cd01718c-a249-47b9-8dea-e6d828bc84c6",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "6165a87f-4142-4cb6-83de-924772ab9260",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION_EXCLUSION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "measurePopulationObservation0",
                  criteriaReference: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
                  name: PopulationType.MEASURE_POPULATION_OBSERVATION,
                  expected: 6,
                  actual: null,
                },
              ],
            },
          ],
        },
        {
          groupId: "659c2c504fc1aa5fa9481b72",
          scoring: "Continuous Variable",
          populationBasis: "false",
          populationValues: [
            {
              id: "bf2205fc-9035-4e60-942c-e832dbab0ab7",
              criteriaReference: null,
              name: PopulationType.INITIAL_POPULATION,
              expected: 3,
              actual: null,
            },
            {
              id: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
              criteriaReference: null,
              name: PopulationType.MEASURE_POPULATION,
              expected: 3,
              actual: null,
            },
            {
              id: "3739ad38-81bc-434b-be38-596af2dfaf66",
              criteriaReference: null,
              name: PopulationType.MEASURE_POPULATION_EXCLUSION,
              expected: 1,
              actual: null,
            },
            {
              id: "measurePopulationObservation0",
              criteriaReference: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
              name: PopulationType.MEASURE_POPULATION_OBSERVATION,
              expected: 480,
              actual: null,
            },
            {
              id: "measurePopulationObservation1",
              criteriaReference: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
              name: PopulationType.MEASURE_POPULATION_OBSERVATION,
              expected: 360,
              actual: null,
            },
          ],
          stratificationValues: [
            {
              id: "28378991-e7df-4d28-8903-e94f2a19ce82",
              name: "Strata-1",
              expected: 1,
              actual: null,
              populationValues: [
                {
                  id: "bf2205fc-9035-4e60-942c-e832dbab0ab7",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION,
                  expected: 1,
                  actual: null,
                },
                {
                  id: "3739ad38-81bc-434b-be38-596af2dfaf66",
                  criteriaReference: null,
                  name: PopulationType.MEASURE_POPULATION_EXCLUSION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "measurePopulationObservation0",
                  criteriaReference: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
                  name: PopulationType.MEASURE_POPULATION_OBSERVATION,
                  expected: 360,
                  actual: null,
                },
              ],
            },
          ],
        },
      ],
      executionStatus: "pass",
    },
    measureGroups: [
      {
        id: "659c25644fc1aa5fa9481b70",
        scoring: "Continuous Variable",
        populations: [
          {
            id: "cd01718c-a249-47b9-8dea-e6d828bc84c6",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
            name: PopulationType.MEASURE_POPULATION,
            definition: "Measure Population",
            associationType: null,
            description: "",
          },
          {
            id: "6165a87f-4142-4cb6-83de-924772ab9260",
            name: PopulationType.MEASURE_POPULATION_EXCLUSION,
            definition: "Measure Population Exclusion",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "7d33f3c9-d2fc-481e-bb83-154af6956612",
            definition: "Measure Observation Hours",
            description: null,
            criteriaReference: "4da85d13-34b1-4d2f-9b36-81ac126b44a6",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
        ],
        groupDescription: "",
        improvementNotation: "",
        rateAggregation: "",
        measureGroupTypes: null,
        scoringUnit: "",
        stratifications: [
          {
            id: "bfd47335-3d0c-4234-8bab-14ab8504ec92",
            description: "",
            cqlDefinition: "Strat 1",
            association: null,
          },
          {
            id: "79a18154-74ce-4fc5-af2e-82b167dc5685",
            description: "",
            cqlDefinition: "Strat 2",
            association: null,
          },
        ],
        populationBasis: "false",
      },
      {
        id: "659c2c504fc1aa5fa9481b72",
        scoring: "Continuous Variable",
        populations: [
          {
            id: "bf2205fc-9035-4e60-942c-e832dbab0ab7",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
            name: PopulationType.MEASURE_POPULATION,
            definition: "Measure Population",
            associationType: null,
            description: "",
          },
          {
            id: "3739ad38-81bc-434b-be38-596af2dfaf66",
            name: PopulationType.MEASURE_POPULATION_EXCLUSION,
            definition: "Measure Population Exclusion",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "11bbc137-5fd2-491d-b54f-76a6f5d216dd",
            definition: "Measure Observation minutes",
            description: null,
            criteriaReference: "a597cb80-2d21-4fc1-992f-1444f40f58fe",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
        ],
        groupDescription: "",
        improvementNotation: "",
        rateAggregation: "",
        measureGroupTypes: null,
        scoringUnit: "",
        stratifications: [
          {
            id: "28378991-e7df-4d28-8903-e94f2a19ce82",
            description: "",
            cqlDefinition: "Strat 2",
            association: null,
          },
        ],
        populationBasis: "false",
      },
    ],
    patientResults: {
      "659c25644fc1aa5fa9481b70": {
        IPP: 3,
        observation_values: [8, 480, 6, 360],
        MSRPOPL: 3,
        MSRPOPLEX: 1,
        episode_results: {
          "659c279ea2c0ac00001870be": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            observation_values: [8, 480],
          },
          "659c2bbba2c0ac0000187988": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            observation_values: [6, 360],
          },
          "659c27caa2c0ac00001871f8": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 1,
            observation_values: [],
          },
        },
        clause_results: null,
        patient: "659c2785a2c0ac0000187066",
        measure: "659c2e93cdafd80000ba9b2c",
        state: "complete",
      },
      "659c2c504fc1aa5fa9481b72": {
        IPP: 3,
        observation_values: [8, 480, 6, 360],
        MSRPOPL: 3,
        MSRPOPLEX: 1,
        episode_results: {
          "659c279ea2c0ac00001870be": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            observation_values: [8, 480],
          },
          "659c2bbba2c0ac0000187988": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            observation_values: [6, 360],
          },
          "659c27caa2c0ac00001871f8": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 1,
            observation_values: [],
          },
        },
        clause_results: null,
        patient: "659c2785a2c0ac0000187066",
        measure: "659c2e93cdafd80000ba9b2c",
        state: "complete",
      },
      PopulationSet_1_Stratification_1: {
        IPP: 1,
        observation_values: [8, 480],
        MSRPOPL: 1,
        MSRPOPLEX: 0,
        STRAT: 1,
        episode_results: {
          "659c279ea2c0ac00001870be": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            STRAT: 1,
            observation_values: [8, 480],
          },
          "659c2bbba2c0ac0000187988": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
          "659c27caa2c0ac00001871f8": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
        },
        clause_results: null,
        patient: "659c2785a2c0ac0000187066",
        measure: "659c2e93cdafd80000ba9b2c",
        state: "complete",
      },
      PopulationSet_1_Stratification_2: {
        IPP: 1,
        observation_values: [6, 360],
        MSRPOPL: 1,
        MSRPOPLEX: 0,
        STRAT: 1,
        episode_results: {
          "659c279ea2c0ac00001870be": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
          "659c2bbba2c0ac0000187988": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            STRAT: 1,
            observation_values: [6, 360],
          },
          "659c27caa2c0ac00001871f8": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
        },
        clause_results: null,
        patient: "659c2785a2c0ac0000187066",
        measure: "659c2e93cdafd80000ba9b2c",
        state: "complete",
      },
      PopulationSet_2_Stratification_1: {
        IPP: 1,
        observation_values: [6, 360],
        MSRPOPL: 1,
        MSRPOPLEX: 0,
        STRAT: 1,
        episode_results: {
          "659c279ea2c0ac00001870be": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
          "659c2bbba2c0ac0000187988": {
            IPP: 1,
            MSRPOPL: 1,
            MSRPOPLEX: 0,
            STRAT: 1,
            observation_values: [6, 360],
          },
          "659c27caa2c0ac00001871f8": {
            IPP: 0,
            MSRPOPL: 0,
            MSRPOPLEX: 0,
            STRAT: 0,
            observation_values: [],
          },
        },
        clause_results: null,
        patient: "659c2785a2c0ac0000187066",
        measure: "659c2e93cdafd80000ba9b2c",
        state: "complete",
      },
    },
  };

export const RATIO_PATIENTBASED_WITH_OBS_RESULTS: QdmTestCaseProcessingScenario =
  {
    testCase: {
      id: "id1",
      name: "Test Ratio",
      title: "Test1",
      series: "",
      description: "",
      createdAt: "2023-10-30T21:23:06.586Z",
      createdBy: "Test1",
      lastModifiedAt: "2023-10-12T21:07:21.573Z",
      lastModifiedBy: "Test1",
      validResource: true,
      json: '{"qdmVersion":"5.6","dataElements":[{"dataElementCodes":[{"code":"448951000124107","system":"2.16.840.1.113883.6.96","version":null,"display":"Admission to observation unit (procedure)"}],"_id":"65401ebfd9e14800002ab193","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Observation Services","codeListId":"2.16.840.1.113762.1.4.1111.143","id":"65401ec2d9e14800002ab19c","authorDatetime":"2023-10-26T00:00:00.000+00:00","relevantPeriod":{"low":"2023-10-18T00:00:00.000+00:00","high":"2023-10-25T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]},{"dataElementCodes":[{"code":"4525004","system":"2.16.840.1.113883.6.96","version":null,"display":"Emergency department patient visit (procedure)"}],"_id":"65401ebfd9e14800002ab197","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Emergency Department Visit","codeListId":"2.16.840.1.113883.3.117.1.7.1.292","id":"65401ed9d9e14800002ab1b2","relevantPeriod":{"low":"2023-10-19T00:00:00.000+00:00","high":"2023-10-24T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]}],"_id":"65401ebfd9e14800002ab199"}',
      patientId: "dc788bd3-f02b-4b3c-89a2-104c0b6e753e",
      hapiOperationOutcome: null,
      groupPopulations: [
        {
          groupId: "Group1",
          scoring: MeasureScoring.RATIO,
          populationBasis: "true",
          populationValues: [
            {
              name: "initialPopulation",
              expected: true,
              actual: false,
            },
            {
              name: "initialPopulation",
              expected: true,
              actual: false,
            },
            {
              name: "denominator",
              expected: true,
              actual: false,
            },
            {
              name: "numerator",
              expected: true,
              actual: false,
            },
            {
              name: "numeratorObservation",
              expected: "30",
              actual: null,
            },
          ] as PopulationExpectedValue[],
          stratificationValues: [],
        },
      ],
      executionStatus: "fail",
    },
    measureGroups: [
      {
        id: "Group1",
        scoring: MeasureScoring.RATIO,
        populations: [
          {
            id: "g1pop1",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "g1pop2",
            name: PopulationType.DENOMINATOR,
            definition: "foo3",
            associationType: null,
            description: "",
          },
          {
            id: "g1pop3",
            name: PopulationType.DENOMINATOR_EXCLUSION,
            definition: "foo7",
            associationType: null,
            description: "",
          },
          {
            id: "g1pop4",
            name: PopulationType.NUMERATOR,
            definition: "foo2",
            associationType: null,
            description: "",
          },
          {
            id: "g1pop5",
            name: PopulationType.NUMERATOR_EXCLUSION,
            definition: "foo12",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "observ1",
            definition: "Numer Observation",
            description: null,
            criteriaReference: "g1pop4",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
        ],
        measureGroupTypes: null,
      },
    ],
    measure: {
      id: "653a7e0ea58fe605001e6c5e",
      cqlLibraryName: "QdmRatioParientBased",
      measureName: "QdmRatioParientBased",
      active: true,
      cqlErrors: false,
      errors: [],
      cql: 'library QdmRatioParientBased version \'0.0.000\'\n\nusing QDM version \'5.6\'\n\ncodesystem "LOINC": \'urn:oid:2.16.840.1.113883.6.1\' \ncodesystem "SNOMEDCT": \'urn:oid:2.16.840.1.113883.6.96\' \n\n\nvalueset "Chemistry Tests": \'urn:oid:2.16.840.1.113762.1.4.1147.82\'\nvalueset "Emergency Department Visit": \'urn:oid:2.16.840.1.113883.3.117.1.7.1.292\'\nvalueset "Encounter Inpatient": \'urn:oid:2.16.840.1.113883.3.666.5.307\'\nvalueset "Ethnicity": \'urn:oid:2.16.840.1.114222.4.11.837\' \nvalueset "Lab Communications": \'urn:oid:2.16.840.1.113762.1.4.1147.61\' \nvalueset "Observation Services": \'urn:oid:2.16.840.1.113762.1.4.1111.143\' \n\ncode "Birth date": \'21112-8\' from "LOINC" display \'Birth date\'\ncode "Detected (qualifier value)": \'260373001\' from "SNOMEDCT" display \'Detected (qualifier value)\'\n\nparameter "Measurement Period" Interval<DateTime>\n\ncontext Patient\n\ndefine "Initial Population":\n  exists "Qualifying Encounters"\n   // with "Communication" ValueCommunicated\n//      such that ValueCommunicated.sentDatetime during QEncounters.relevantPeriod\n\ndefine "Denominator":\n  "Initial Population"\n  \ndefine "Numerator":\n exists ["Encounter, Performed": "Emergency Department Visit"] Encounter\n        where Encounter.relevantPeriod ends during "Measurement Period"\n  \n\ndefine "Qualifying Encounters":\n  ( ["Encounter, Performed": "Encounter Inpatient"]\n    union ["Encounter, Performed": "Emergency Department Visit"]\n    union ["Encounter, Performed": "Observation Services"] ) Encounter\n    where Encounter.relevantPeriod ends during "Measurement Period"\n\n\ndefine "Denonimator Exclusion":\n    exists ["Encounter, Performed": "Observation Services"]\n   \ndefine function "Denom Observation"():\n 10  \n\ndefine function "Numer Observation"():\n 12  \n',
      elmJson:
        '{"library":{"identifier":{"id":"QdmRatioParientBased","version":"0.0.000"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localId":"1","locator":"3:1-3:23","localIdentifier":"QDM","uri":"urn:healthit-gov:qdm:v5_6","version":"5.6","annotation":[{"type":"Annotation","s":{"r":"1","s":[{"value":["","using "]},{"s":[{"value":["QDM"]}]},{"value":[" version ","\'5.6\'"]}]}}]}]},"parameters":{"def":[{"localId":"16","locator":"19:1-19:49","name":"Measurement Period","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"16","s":[{"value":["","parameter ","\\"Measurement Period\\""," "]},{"r":"15","s":[{"value":["Interval<"]},{"r":"14","s":[{"value":["DateTime"]}]},{"value":[">"]}]}]}}],"resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}},"parameterTypeSpecifier":{"localId":"15","locator":"19:32-19:49","type":"IntervalTypeSpecifier","resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}},"pointType":{"localId":"14","locator":"19:41-19:48","resultTypeName":"{urn:hl7-org:elm-types:r1}DateTime","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},"codeSystems":{"def":[{"localId":"2","locator":"5:1-5:51","resultTypeName":"{urn:hl7-org:elm-types:r1}CodeSystem","name":"LOINC","id":"urn:oid:2.16.840.1.113883.6.1","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"2","s":[{"value":["","codesystem ","\\"LOINC\\"",": ","\'urn:oid:2.16.840.1.113883.6.1\'"]}]}}]},{"localId":"3","locator":"6:1-6:55","resultTypeName":"{urn:hl7-org:elm-types:r1}CodeSystem","name":"SNOMEDCT","id":"urn:oid:2.16.840.1.113883.6.96","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"3","s":[{"value":["","codesystem ","\\"SNOMEDCT\\"",": ","\'urn:oid:2.16.840.1.113883.6.96\'"]}]}}]}]},"valueSets":{"def":[{"localId":"4","locator":"9:1-9:67","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Chemistry Tests","id":"urn:oid:2.16.840.1.113762.1.4.1147.82","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"4","s":[{"value":["","valueset ","\\"Chemistry Tests\\"",": ","\'urn:oid:2.16.840.1.113762.1.4.1147.82\'"]}]}}]},{"localId":"5","locator":"10:1-10:82","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Emergency Department Visit","id":"urn:oid:2.16.840.1.113883.3.117.1.7.1.292","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"5","s":[{"value":["","valueset ","\\"Emergency Department Visit\\"",": ","\'urn:oid:2.16.840.1.113883.3.117.1.7.1.292\'"]}]}}]},{"localId":"6","locator":"11:1-11:71","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Encounter Inpatient","id":"urn:oid:2.16.840.1.113883.3.666.5.307","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"6","s":[{"value":["","valueset ","\\"Encounter Inpatient\\"",": ","\'urn:oid:2.16.840.1.113883.3.666.5.307\'"]}]}}]},{"localId":"7","locator":"12:1-12:58","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Ethnicity","id":"urn:oid:2.16.840.1.114222.4.11.837","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"7","s":[{"value":["","valueset ","\\"Ethnicity\\"",": ","\'urn:oid:2.16.840.1.114222.4.11.837\'"]}]}}]},{"localId":"8","locator":"13:1-13:70","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Lab Communications","id":"urn:oid:2.16.840.1.113762.1.4.1147.61","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"8","s":[{"value":["","valueset ","\\"Lab Communications\\"",": ","\'urn:oid:2.16.840.1.113762.1.4.1147.61\'"]}]}}]},{"localId":"9","locator":"14:1-14:73","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Observation Services","id":"urn:oid:2.16.840.1.113762.1.4.1111.143","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"9","s":[{"value":["","valueset ","\\"Observation Services\\"",": ","\'urn:oid:2.16.840.1.113762.1.4.1111.143\'"]}]}}]}]},"codes":{"def":[{"localId":"11","locator":"16:1-16:62","resultTypeName":"{urn:hl7-org:elm-types:r1}Code","name":"Birth date","id":"21112-8","display":"Birth date","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"11","s":[{"value":["","code ","\\"Birth date\\"",": ","\'21112-8\'"," from "]},{"r":"10","s":[{"value":["\\"LOINC\\""]}]},{"value":[" display ","\'Birth date\'"]}]}}],"codeSystem":{"localId":"10","locator":"16:35-16:41","resultTypeName":"{urn:hl7-org:elm-types:r1}CodeSystem","name":"LOINC"}},{"localId":"13","locator":"17:1-17:99","resultTypeName":"{urn:hl7-org:elm-types:r1}Code","name":"Detected (qualifier value)","id":"260373001","display":"Detected (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"13","s":[{"value":["","code ","\\"Detected (qualifier value)\\"",": ","\'260373001\'"," from "]},{"r":"12","s":[{"value":["\\"SNOMEDCT\\""]}]},{"value":[" display ","\'Detected (qualifier value)\'"]}]}}],"codeSystem":{"localId":"12","locator":"17:53-17:62","resultTypeName":"{urn:hl7-org:elm-types:r1}CodeSystem","name":"SNOMEDCT"}}]},"contexts":{"def":[{"locator":"21:1-21:15","name":"Patient"}]},"statements":{"def":[{"locator":"21:1-21:15","name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"locator":"21:1-21:15","dataType":"{urn:healthit-gov:qdm:v5_6}Patient","templateId":"Patient","type":"Retrieve"}}},{"localId":"28","locator":"36:1-40:67","name":"Qualifying Encounters","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"28","s":[{"value":["","define ","\\"Qualifying Encounters\\"",":\\n  "]},{"r":"27","s":[{"s":[{"r":"22","s":[{"r":"21","s":[{"value":["( "]},{"r":"21","s":[{"r":"19","s":[{"r":"17","s":[{"value":["[","\\"Encounter, Performed\\"",": "]},{"s":[{"value":["\\"Encounter Inpatient\\""]}]},{"value":["]"]}]},{"value":["\\n    union "]},{"r":"18","s":[{"value":["[","\\"Encounter, Performed\\"",": "]},{"s":[{"value":["\\"Emergency Department Visit\\""]}]},{"value":["]"]}]}]},{"value":["\\n    union "]},{"r":"20","s":[{"value":["[","\\"Encounter, Performed\\"",": "]},{"s":[{"value":["\\"Observation Services\\""]}]},{"value":["]"]}]}]},{"value":[" )"]}]},{"value":[" ","Encounter"]}]}]},{"value":["\\n    "]},{"r":"26","s":[{"value":["where "]},{"r":"26","s":[{"r":"24","s":[{"r":"23","s":[{"value":["Encounter"]}]},{"value":["."]},{"r":"24","s":[{"value":["relevantPeriod"]}]}]},{"r":"26","value":[" ","ends during"," "]},{"r":"25","s":[{"value":["\\"Measurement Period\\""]}]}]}]}]}]}}],"resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"expression":{"localId":"27","locator":"37:3-40:67","type":"Query","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"source":[{"localId":"22","locator":"37:3-39:70","alias":"Encounter","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"expression":{"localId":"21","locator":"37:3-39:60","type":"Union","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"operand":[{"localId":"19","locator":"37:5-38:64","type":"Union","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"operand":[{"localId":"17","locator":"37:5-37:51","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"codes":{"locator":"37:30-37:50","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Encounter Inpatient","preserve":true,"type":"ValueSetRef"}},{"localId":"18","locator":"38:11-38:64","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"codes":{"locator":"38:36-38:63","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}]},{"localId":"20","locator":"39:11-39:58","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"codes":{"locator":"39:36-39:57","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Observation Services","preserve":true,"type":"ValueSetRef"}}]}}],"relationship":[],"where":{"localId":"26","locator":"40:5-40:67","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","type":"In","operand":[{"locator":"40:36-40:39","type":"End","operand":{"localId":"24","locator":"40:11-40:34","path":"relevantPeriod","scope":"Encounter","type":"Property","resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}},{"localId":"25","locator":"40:48-40:67","name":"Measurement Period","type":"ParameterRef","resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]}}},{"localId":"31","locator":"23:1-24:32","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","name":"Initial Population","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"31","s":[{"value":["","define ","\\"Initial Population\\"",":\\n  "]},{"r":"30","s":[{"value":["exists "]},{"r":"29","s":[{"value":["\\"Qualifying Encounters\\""]}]}]}]}}],"expression":{"localId":"30","locator":"24:3-24:32","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","type":"Exists","operand":{"localId":"29","locator":"24:10-24:32","name":"Qualifying Encounters","type":"ExpressionRef","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}}}},{"localId":"33","locator":"28:1-29:22","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","name":"Denominator","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"33","s":[{"value":["// with \\"Communication\\" ValueCommunicated\\n//      such that ValueCommunicated.sentDatetime during QEncounters.relevantPeriod\\n\\n","define ","\\"Denominator\\"",":\\n  "]},{"r":"32","s":[{"value":["\\"Initial Population\\""]}]}]}}],"expression":{"localId":"32","locator":"29:3-29:22","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","name":"Initial Population","type":"ExpressionRef"}},{"localId":"42","locator":"31:1-33:71","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","name":"Numerator","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"42","s":[{"value":["","define ","\\"Numerator\\"",":\\n "]},{"r":"41","s":[{"value":["exists "]},{"r":"40","s":[{"s":[{"r":"35","s":[{"r":"34","s":[{"r":"34","s":[{"value":["[","\\"Encounter, Performed\\"",": "]},{"s":[{"value":["\\"Emergency Department Visit\\""]}]},{"value":["]"]}]}]},{"value":[" ","Encounter"]}]}]},{"value":["\\n        "]},{"r":"39","s":[{"value":["where "]},{"r":"39","s":[{"r":"37","s":[{"r":"36","s":[{"value":["Encounter"]}]},{"value":["."]},{"r":"37","s":[{"value":["relevantPeriod"]}]}]},{"r":"39","value":[" ","ends during"," "]},{"r":"38","s":[{"value":["\\"Measurement Period\\""]}]}]}]}]}]}]}}],"expression":{"localId":"41","locator":"32:2-33:71","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","type":"Exists","operand":{"localId":"40","locator":"32:9-33:71","type":"Query","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"source":[{"localId":"35","locator":"32:9-32:72","alias":"Encounter","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"expression":{"localId":"34","locator":"32:9-32:62","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"codes":{"locator":"32:34-32:61","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"39","locator":"33:9-33:71","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","type":"In","operand":[{"locator":"33:40-33:43","type":"End","operand":{"localId":"37","locator":"33:15-33:38","path":"relevantPeriod","scope":"Encounter","type":"Property","resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}},{"localId":"38","locator":"33:52-33:71","name":"Measurement Period","type":"ParameterRef","resultTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]}}}},{"localId":"45","locator":"43:1-44:59","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","name":"Denonimator Exclusion","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"45","s":[{"value":["","define ","\\"Denonimator Exclusion\\"",":\\n    "]},{"r":"44","s":[{"value":["exists "]},{"r":"43","s":[{"value":["[","\\"Encounter, Performed\\"",": "]},{"s":[{"value":["\\"Observation Services\\""]}]},{"value":["]"]}]}]}]}}],"expression":{"localId":"44","locator":"44:5-44:59","resultTypeName":"{urn:hl7-org:elm-types:r1}Boolean","type":"Exists","operand":{"localId":"43","locator":"44:12-44:59","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","resultTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}},"codes":{"locator":"44:37-44:58","resultTypeName":"{urn:hl7-org:elm-types:r1}ValueSet","name":"Observation Services","preserve":true,"type":"ValueSetRef"}}}},{"localId":"47","locator":"46:1-47:3","resultTypeName":"{urn:hl7-org:elm-types:r1}Integer","name":"Denom Observation","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"47","s":[{"value":["","define function ","\\"Denom Observation\\"","():\\n "]},{"r":"46","s":[{"r":"46","value":["10"]}]}]}}],"expression":{"localId":"46","locator":"47:2-47:3","resultTypeName":"{urn:hl7-org:elm-types:r1}Integer","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"10","type":"Literal"},"operand":[]},{"localId":"49","locator":"49:1-50:3","resultTypeName":"{urn:hl7-org:elm-types:r1}Integer","name":"Numer Observation","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"49","s":[{"value":["","define function ","\\"Numer Observation\\"","():\\n "]},{"r":"48","s":[{"r":"48","value":["12"]}]}]}}],"expression":{"localId":"48","locator":"50:2-50:3","resultTypeName":"{urn:hl7-org:elm-types:r1}Integer","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"12","type":"Literal"},"operand":[]}]}},"externalErrors":[]}',
      elmXml: null,
      testCases: [
        {
          id: "65401eba1b2c1c16e90c39fb",
          name: null,
          title: "Test1",
          series: "",
          description: "",
          createdAt: "2023-10-30T21:23:06.586Z",
          createdBy: "Test1",
          lastModifiedAt: "2023-10-30T21:27:36.851Z",
          lastModifiedBy: "Test1",
          validResource: true,
          json: '{"qdmVersion":"5.6","dataElements":[{"dataElementCodes":[{"code":"448951000124107","system":"2.16.840.1.113883.6.96","version":null,"display":"Admission to observation unit (procedure)"}],"_id":"65401ebfd9e14800002ab193","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Observation Services","codeListId":"2.16.840.1.113762.1.4.1111.143","id":"65401ec2d9e14800002ab19c","authorDatetime":"2023-10-26T00:00:00.000+00:00","relevantPeriod":{"low":"2023-10-18T00:00:00.000+00:00","high":"2023-10-25T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]},{"dataElementCodes":[{"code":"4525004","system":"2.16.840.1.113883.6.96","version":null,"display":"Emergency department patient visit (procedure)"}],"_id":"65401ebfd9e14800002ab197","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Emergency Department Visit","codeListId":"2.16.840.1.113883.3.117.1.7.1.292","id":"65401ed9d9e14800002ab1b2","relevantPeriod":{"low":"2023-10-19T00:00:00.000+00:00","high":"2023-10-24T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]}],"_id":"65401ebfd9e14800002ab199"}',
          patientId: "8f49150a-0fde-46f5-ab97-4583736e7ad7",
          hapiOperationOutcome: null,
          groupPopulations: [
            {
              groupId: "65401ea41b2c1c16e90c39fa",
              scoring: "Ratio",
              populationBasis: "true",
              populationValues: [
                {
                  id: "385976a9-a392-47a0-b3d8-6d80e8569c98",
                  criteriaReference: null,
                  name: "initialPopulation",
                  expected: true,
                  actual: false,
                },
                {
                  id: "317e0f81-22b8-447c-9980-4402ab25abbd",
                  criteriaReference: null,
                  name: "initialPopulation",
                  expected: true,
                  actual: false,
                },
                {
                  id: "3993aadf-b03f-434b-9f95-02de8b64b2bf",
                  criteriaReference: null,
                  name: "denominator",
                  expected: true,
                  actual: false,
                },
                {
                  id: "282d091f-a657-4526-afb1-e5a2811e7638",
                  criteriaReference: null,
                  name: "numerator",
                  expected: true,
                  actual: false,
                },
                {
                  id: "numeratorObservation0",
                  criteriaReference: "282d091f-a657-4526-afb1-e5a2811e7638",
                  name: "numeratorObservation",
                  expected: "30",
                  actual: null,
                },
              ],
              stratificationValues: [],
            },
          ],
          executionStatus: "NA",
        },
      ],
      groups: [
        {
          id: "65401ea41b2c1c16e90c39fa",
          scoring: "Ratio",
          populations: [
            {
              id: "385976a9-a392-47a0-b3d8-6d80e8569c98",
              name: "initialPopulation",
              definition: "Initial Population",
              associationType: "Denominator",
              description: "",
            },
            {
              id: "317e0f81-22b8-447c-9980-4402ab25abbd",
              name: "initialPopulation",
              definition: "Initial Population",
              associationType: "Numerator",
              description: "",
            },
            {
              id: "3993aadf-b03f-434b-9f95-02de8b64b2bf",
              name: "denominator",
              definition: "Denominator",
              associationType: null,
              description: "",
            },
            {
              id: "065916c0-aa58-4f47-80e5-9a28c86fb03c",
              name: "denominatorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
            {
              id: "282d091f-a657-4526-afb1-e5a2811e7638",
              name: "numerator",
              definition: "Numerator",
              associationType: null,
              description: "",
            },
            {
              id: "1eea3471-44ff-4f63-a52b-59c55ad21ac6",
              name: "numeratorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
          ],
          measureObservations: [
            {
              id: "12a6b4b0-c2e7-4a80-9d25-1159ed5cbfbc",
              definition: "Numer Observation",
              description: null,
              criteriaReference: "282d091f-a657-4526-afb1-e5a2811e7638",
              aggregateMethod: "Count",
            },
          ],
          groupDescription: "",
          improvementNotation: "",
          rateAggregation: "",
          measureGroupTypes: null,
          scoringUnit: "",
          stratifications: [],
          populationBasis: "true",
        },
      ],

      createdAt: "2023-10-26T14:56:14.802Z",
      createdBy: "Test1",
      measurementPeriodStart: "2023-01-02T00:00:00.000+00:00",
      measurementPeriodEnd: "2023-12-22T23:59:59.999+00:00",
      model: "QDM v5.6",
      scoring: "Ratio",
      patientBasis: true,
    } as unknown as Measure,
    patientResults: {
      Group1: {
        IPP: 1,
        DENOM: 1,
        DENEX: 0,
        NUMER: 1,
        NUMEX: 0,
        observation_values: [12],
        clause_results: null,
        patient: "65401ebfd9e14800002ab199",
        measure: "6541113c15c2db0000aeb0ba",
        state: "complete",
      },
    },
  };

export const RATIO_EPISODEBASED_WITH_OBS_RESULTS: QdmTestCaseProcessingScenario =
  {
    testCase: {
      id: "6540f085854d323018920e02",
      name: null,
      title: "TC1",
      series: "",
      description: "",
      createdAt: "2023-10-31T12:18:13.162Z",
      createdBy: "nate.moraca@semanticbits.com",
      lastModifiedAt: "2023-11-01T16:55:41.081Z",
      lastModifiedBy: "nate.moraca@semanticbits.com",
      validResource: true,
      executionStatus: ExecutionStatusType.NA,
      json: "{}",
      patientId: "fdbb6404-872b-4d42-92fa-9c9f952da64a",
      hapiOperationOutcome: null,
      groupPopulations: [
        {
          groupId: "6540ef82854d323018920e01",
          scoring: "Ratio",
          populationBasis: "false",
          populationValues: [
            {
              id: "13bb7956-876f-4e20-aa64-247c282348ec",
              criteriaReference: null,
              name: PopulationType.INITIAL_POPULATION,
              expected: 4,
              actual: 4,
            },
            {
              id: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
              criteriaReference: null,
              name: PopulationType.DENOMINATOR,
              expected: 4,
              actual: 4,
            },
            {
              id: "denominatorObservation0",
              criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 345600,
              actual: 345600,
            },
            {
              id: "denominatorObservation1",
              criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 518400,
              actual: 518400,
            },
            {
              id: "8994a974-a902-4ecf-9f9a-515d67f9b64c",
              criteriaReference: null,
              name: PopulationType.DENOMINATOR_EXCLUSION,
              expected: 2,
              actual: 2,
            },
            {
              id: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
              criteriaReference: null,
              name: PopulationType.NUMERATOR,
              expected: 1,
              actual: 1,
            },
            {
              id: "numeratorObservation0",
              criteriaReference: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 6,
              actual: 6,
            },
          ],
          stratificationValues: [],
        },
        {
          groupId: "65427991410db87ca98e0d4b",
          scoring: "Ratio",
          populationBasis: "false",
          populationValues: [
            {
              id: "e3e0dbce-db01-452f-908b-b7eaba80288c",
              criteriaReference: null,
              name: PopulationType.INITIAL_POPULATION,
              expected: 4,
              actual: 4,
            },
            {
              id: "e9b73fa7-d18d-46c1-9522-f4bf32f060e2",
              criteriaReference: null,
              name: PopulationType.DENOMINATOR,
              expected: 4,
              actual: 4,
            },
            {
              id: "27865863-a129-42eb-902d-eaa63040f9a8",
              criteriaReference: null,
              name: PopulationType.NUMERATOR,
              expected: 3,
              actual: 3,
            },
            {
              id: "numeratorObservation0",
              criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 12,
              actual: 12,
            },
            {
              id: "numeratorObservation1",
              criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 18,
              actual: 18,
            },
            {
              id: "numeratorObservation2",
              criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 6,
              actual: 6,
            },
          ],
          stratificationValues: [],
        },
        {
          groupId: "6542822e410db87ca98e0d4d",
          scoring: "Ratio",
          populationBasis: "false",
          populationValues: [
            {
              id: "1a92da52-338a-4ba8-97f5-2e39d6fb1265",
              criteriaReference: null,
              name: PopulationType.INITIAL_POPULATION,
              expected: 4,
              actual: 4,
            },
            {
              id: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              criteriaReference: null,
              name: PopulationType.DENOMINATOR,
              expected: 4,
              actual: 4,
            },
            {
              id: "denominatorObservation0",
              criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 0,
              actual: null,
            },
            {
              id: "denominatorObservation1",
              criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 0,
              actual: null,
            },
            {
              id: "denominatorObservation2",
              criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 0,
              actual: null,
            },
            {
              id: "denominatorObservation3",
              criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              name: PopulationType.DENOMINATOR_OBSERVATION,
              expected: 0,
              actual: null,
            },
            {
              id: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              criteriaReference: null,
              name: PopulationType.NUMERATOR,
              expected: 3,
              actual: 3,
            },
            {
              id: "numeratorObservation0",
              criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 0,
              actual: 12,
            },
            {
              id: "numeratorObservation1",
              criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 0,
              actual: 18,
            },
            {
              id: "numeratorObservation2",
              criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              name: PopulationType.NUMERATOR_OBSERVATION,
              expected: 0,
              actual: 6,
            },
          ],
          stratificationValues: [],
        },
      ],
    },
    measureGroups: [
      {
        id: "6540ef82854d323018920e01",
        scoring: "Ratio",
        populations: [
          {
            id: "13bb7956-876f-4e20-aa64-247c282348ec",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
            name: PopulationType.DENOMINATOR,
            definition: "Denominator",
            associationType: null,
            description: "",
          },
          {
            id: "8994a974-a902-4ecf-9f9a-515d67f9b64c",
            name: PopulationType.DENOMINATOR_EXCLUSION,
            definition: "Denoninator Exclusion",
            associationType: null,
            description: "",
          },
          {
            id: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
            name: PopulationType.NUMERATOR,
            definition: "Numerator",
            associationType: null,
            description: "",
          },
          {
            id: "e07402cf-00a0-4b1a-8541-67e5e43d0563",
            name: PopulationType.NUMERATOR_EXCLUSION,
            definition: "",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "f3c383a9-3be2-497f-989a-4c606c9ffaee",
            definition: "denomObs",
            description: null,
            criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
            aggregateMethod: AggregateFunctionType.MAXIMUM,
          },
          {
            id: "1f731b1b-57fd-41c3-ad73-cd9d113c647d",
            definition: "numerObs",
            description: null,
            criteriaReference: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
        ],
        groupDescription: "",
        improvementNotation: "",
        rateAggregation: "",
        measureGroupTypes: null,
        scoringUnit: "",
        stratifications: [],
        populationBasis: "false",
      },
      {
        id: "65427991410db87ca98e0d4b",
        scoring: "Ratio",
        populations: [
          {
            id: "e3e0dbce-db01-452f-908b-b7eaba80288c",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "e9b73fa7-d18d-46c1-9522-f4bf32f060e2",
            name: PopulationType.DENOMINATOR,
            definition: "Denominator",
            associationType: null,
            description: "",
          },
          {
            id: "5db0a7bd-c893-49e7-b6dc-4b183988c24e",
            name: PopulationType.DENOMINATOR_EXCLUSION,
            definition: "",
            associationType: null,
            description: "",
          },
          {
            id: "27865863-a129-42eb-902d-eaa63040f9a8",
            name: PopulationType.NUMERATOR,
            definition: "Numerator",
            associationType: null,
            description: "",
          },
          {
            id: "1b00f14b-7b0b-40e8-942c-da9391b6952f",
            name: PopulationType.NUMERATOR_EXCLUSION,
            definition: "",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "a15a820b-b621-41e0-ad10-d16c5e32d6f2",
            definition: "numerObs",
            description: null,
            criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
        ],
        groupDescription: "",
        improvementNotation: "",
        rateAggregation: "",
        measureGroupTypes: null,
        scoringUnit: "",
        stratifications: [],
        populationBasis: "false",
      },
      {
        id: "6542822e410db87ca98e0d4d",
        scoring: "Ratio",
        populations: [
          {
            id: "1a92da52-338a-4ba8-97f5-2e39d6fb1265",
            name: PopulationType.INITIAL_POPULATION,
            definition: "Initial Population",
            associationType: null,
            description: "",
          },
          {
            id: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
            name: PopulationType.DENOMINATOR,
            definition: "Denominator",
            associationType: null,
            description: "",
          },
          {
            id: "00ff3893-0435-4b04-90f2-20dba33b3be2",
            name: PopulationType.DENOMINATOR_EXCLUSION,
            definition: "",
            associationType: null,
            description: "",
          },
          {
            id: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
            name: PopulationType.NUMERATOR,
            definition: "Numerator",
            associationType: null,
            description: "",
          },
          {
            id: "b191fdd8-1445-4c04-be9e-89e75e4c0755",
            name: PopulationType.NUMERATOR_EXCLUSION,
            definition: "",
            associationType: null,
            description: "",
          },
        ],
        measureObservations: [
          {
            id: "d900ec36-b995-42e7-9f85-ee0014f5938d",
            definition: "numerObs",
            description: null,
            criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
            aggregateMethod: AggregateFunctionType.COUNT,
          },
          {
            id: "a92a4954-0434-4e0e-82b7-7f9967c9dd50",
            definition: "denomObs",
            description: null,
            criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
            aggregateMethod: AggregateFunctionType.AVERAGE,
          },
        ],
        groupDescription: "",
        improvementNotation: "",
        rateAggregation: "",
        measureGroupTypes: null,
        scoringUnit: "",
        stratifications: [],
        populationBasis: "false",
      },
    ],
    measure: {
      id: "6540ef13854d323018920dff",
      measureHumanReadableId: null,
      measureSetId: "2b2f52d8-a4f6-47ae-a106-bdc74fc10409",
      version: "0.0.000",
      revisionNumber: null,
      state: null,
      cqlLibraryName: "QdmEpisodeRatio1",
      ecqmTitle: "QdmEpisodeRatio1",
      measureName: "QdmEpisodeRatio1",
      active: true,
      cqlErrors: false,
      errors: [],
      cql: "",
      elmJson: "",
      elmXml: null,
      testCases: [
        {
          id: "6540f085854d323018920e02",
          name: null,
          title: "TC1",
          series: "",
          description: "",
          createdAt: "2023-10-31T12:18:13.162Z",
          createdBy: "nate.moraca@semanticbits.com",
          lastModifiedAt: "2023-11-01T16:55:41.081Z",
          lastModifiedBy: "nate.moraca@semanticbits.com",
          validResource: true,
          json: '{"qdmVersion":"5.6","dataElements":[{"dataElementCodes":[],"_id":"6540f092d9f99000000a50bd","qdmTitle":"Patient Characteristic Birthdate","hqmfOid":"2.16.840.1.113883.10.20.28.4.54","qdmCategory":"patient_characteristic","qdmStatus":"birthdate","qdmVersion":"5.6","_type":"QDM::PatientCharacteristicBirthdate","id":"6540f092d9f99000000a50bd","birthDatetime":"2023-10-02T12:18:26.000+00:00"},{"dataElementCodes":[{"code":"F01.A11","system":"2.16.840.1.113883.6.90","version":null,"display":"Vascular dementia, mild, with agitation"}],"_id":"6540f087d9f99000000a50b4","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Dementia","codeListId":"2.16.840.1.113883.3.3157.4043","id":"6540f09cd9f99000000a50bf","relevantPeriod":{"low":"2023-12-30T00:00:00.000+00:00","high":"2024-01-03T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]},{"dataElementCodes":[{"code":"4525004","system":"2.16.840.1.113883.6.96","version":null,"display":"Emergency department patient visit (procedure)"}],"_id":"6540f087d9f99000000a50b8","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Emergency Department Visit","codeListId":"2.16.840.1.113883.3.117.1.7.1.292","id":"6540f0cad9f99000000a50d5","relevantPeriod":{"low":"2024-01-11T00:00:00.000+00:00","high":"2024-01-23T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[{"qdmVersion":"5.6","_type":"QDM::DiagnosisComponent","_id":"6540f388d9f99000000a50fc","code":{"code":"34921009","system":"2.16.840.1.113883.6.96","version":null,"display":"Acute peptic ulcer with perforation but without obstruction (disorder)"},"presentOnAdmissionIndicator":{"code":"32485007","system":"2.16.840.1.113883.6.96","version":null,"display":"Hospital admission (procedure)"},"rank":4}]},{"dataElementCodes":[{"code":"16219201000119101","system":"2.16.840.1.113883.6.96","version":null,"display":"Behavioral disturbance co-occurrent and due to late onset Alzheimer dementia (disorder)"}],"_id":"65423e83a168f90000f0d2ae","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Dementia","codeListId":"2.16.840.1.113883.3.3157.4043","id":"65423e86a168f90000f0d2c0","relevantPeriod":{"low":"2024-04-16T00:00:00.000+00:00","high":"2024-04-22T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]},{"dataElementCodes":[{"code":"4525004","system":"2.16.840.1.113883.6.96","version":null,"display":"Emergency department patient visit (procedure)"}],"_id":"654272dafb870d00005a0968","participant":[],"relatedTo":[],"qdmTitle":"Encounter, Performed","hqmfOid":"2.16.840.1.113883.10.20.28.4.5","qdmCategory":"encounter","qdmStatus":"performed","qdmVersion":"5.6","_type":"QDM::EncounterPerformed","description":"Encounter, Performed: Emergency Department Visit","codeListId":"2.16.840.1.113883.3.117.1.7.1.292","id":"654275f7fb870d00005a0a35","relevantPeriod":{"low":"2024-06-09T04:00:00.000+00:00","high":"2024-06-28T00:00:00.000+00:00","lowClosed":true,"highClosed":true},"facilityLocations":[],"diagnoses":[]}],"_id":"6540f087d9f99000000a50ba","birthDatetime":"2023-10-02T12:18:26.245+00:00"}',
          patientId: "fdbb6404-872b-4d42-92fa-9c9f952da64a",
          hapiOperationOutcome: null,
          groupPopulations: [
            {
              groupId: "6540ef82854d323018920e01",
              scoring: "Ratio",
              populationBasis: "false",
              populationValues: [
                {
                  id: "13bb7956-876f-4e20-aa64-247c282348ec",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
                  criteriaReference: null,
                  name: PopulationType.DENOMINATOR,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "denominatorObservation0",
                  criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: "345600",
                  actual: 345600,
                },
                {
                  id: "denominatorObservation1",
                  criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: "518400",
                  actual: 518400,
                },
                {
                  id: "8994a974-a902-4ecf-9f9a-515d67f9b64c",
                  criteriaReference: null,
                  name: "denominatorExclusion",
                  expected: "2",
                  actual: 2,
                },
                {
                  id: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
                  criteriaReference: null,
                  name: PopulationType.NUMERATOR,
                  expected: "1",
                  actual: 1,
                },
                {
                  id: "numeratorObservation0",
                  criteriaReference: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: "6",
                  actual: 6,
                },
              ],
              stratificationValues: [],
            },
            {
              groupId: "65427991410db87ca98e0d4b",
              scoring: "Ratio",
              populationBasis: "false",
              populationValues: [
                {
                  id: "e3e0dbce-db01-452f-908b-b7eaba80288c",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "e9b73fa7-d18d-46c1-9522-f4bf32f060e2",
                  criteriaReference: null,
                  name: PopulationType.DENOMINATOR,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "27865863-a129-42eb-902d-eaa63040f9a8",
                  criteriaReference: null,
                  name: PopulationType.NUMERATOR,
                  expected: "3",
                  actual: 3,
                },
                {
                  id: "numeratorObservation0",
                  criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: "12",
                  actual: 12,
                },
                {
                  id: "numeratorObservation1",
                  criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: "18",
                  actual: 18,
                },
                {
                  id: "numeratorObservation2",
                  criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: "3",
                  actual: 6,
                },
              ],
              stratificationValues: [],
            },
            {
              groupId: "6542822e410db87ca98e0d4d",
              scoring: "Ratio",
              populationBasis: "false",
              populationValues: [
                {
                  id: "1a92da52-338a-4ba8-97f5-2e39d6fb1265",
                  criteriaReference: null,
                  name: PopulationType.INITIAL_POPULATION,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
                  criteriaReference: null,
                  name: PopulationType.DENOMINATOR,
                  expected: "4",
                  actual: 4,
                },
                {
                  id: "denominatorObservation0",
                  criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "denominatorObservation1",
                  criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "denominatorObservation2",
                  criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "denominatorObservation3",
                  criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
                  name: PopulationType.DENOMINATOR_OBSERVATION,
                  expected: 0,
                  actual: null,
                },
                {
                  id: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
                  criteriaReference: null,
                  name: PopulationType.NUMERATOR,
                  expected: "3",
                  actual: 3,
                },
                {
                  id: "numeratorObservation0",
                  criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: 0,
                  actual: 12,
                },
                {
                  id: "numeratorObservation1",
                  criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: 0,
                  actual: 18,
                },
                {
                  id: "numeratorObservation2",
                  criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
                  name: PopulationType.NUMERATOR_OBSERVATION,
                  expected: 0,
                  actual: 6,
                },
              ],
              stratificationValues: [],
            },
          ],
          executionStatus: "NA",
        },
      ],
      groups: [
        {
          id: "6540ef82854d323018920e01",
          scoring: "Ratio",
          populations: [
            {
              id: "13bb7956-876f-4e20-aa64-247c282348ec",
              name: PopulationType.INITIAL_POPULATION,
              definition: "Initial Population",
              associationType: null,
              description: "",
            },
            {
              id: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
              name: PopulationType.DENOMINATOR,
              definition: "Denominator",
              associationType: null,
              description: "",
            },
            {
              id: "8994a974-a902-4ecf-9f9a-515d67f9b64c",
              name: "denominatorExclusion",
              definition: "Denoninator Exclusion",
              associationType: null,
              description: "",
            },
            {
              id: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
              name: PopulationType.NUMERATOR,
              definition: "Numerator",
              associationType: null,
              description: "",
            },
            {
              id: "e07402cf-00a0-4b1a-8541-67e5e43d0563",
              name: "numeratorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
          ],
          measureObservations: [
            {
              id: "f3c383a9-3be2-497f-989a-4c606c9ffaee",
              definition: "denomObs",
              description: null,
              criteriaReference: "8dfb0e40-7102-4deb-8091-44b73cd5c500",
              aggregateMethod: "Maximum",
            },
            {
              id: "1f731b1b-57fd-41c3-ad73-cd9d113c647d",
              definition: "numerObs",
              description: null,
              criteriaReference: "4c8a2e7d-0d6c-4f58-8b86-7c44759c8017",
              aggregateMethod: "Maximum",
            },
          ],
          groupDescription: "",
          improvementNotation: "",
          rateAggregation: "",
          measureGroupTypes: null,
          scoringUnit: "",
          stratifications: [],
          populationBasis: "false",
        },
        {
          id: "65427991410db87ca98e0d4b",
          scoring: "Ratio",
          populations: [
            {
              id: "e3e0dbce-db01-452f-908b-b7eaba80288c",
              name: PopulationType.INITIAL_POPULATION,
              definition: "Initial Population",
              associationType: null,
              description: "",
            },
            {
              id: "e9b73fa7-d18d-46c1-9522-f4bf32f060e2",
              name: PopulationType.DENOMINATOR,
              definition: "Denominator",
              associationType: null,
              description: "",
            },
            {
              id: "5db0a7bd-c893-49e7-b6dc-4b183988c24e",
              name: "denominatorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
            {
              id: "27865863-a129-42eb-902d-eaa63040f9a8",
              name: PopulationType.NUMERATOR,
              definition: "Numerator",
              associationType: null,
              description: "",
            },
            {
              id: "1b00f14b-7b0b-40e8-942c-da9391b6952f",
              name: "numeratorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
          ],
          measureObservations: [
            {
              id: "a15a820b-b621-41e0-ad10-d16c5e32d6f2",
              definition: "numerObs",
              description: null,
              criteriaReference: "27865863-a129-42eb-902d-eaa63040f9a8",
              aggregateMethod: "Average",
            },
          ],
          groupDescription: "",
          improvementNotation: "",
          rateAggregation: "",
          measureGroupTypes: null,
          scoringUnit: "",
          stratifications: [],
          populationBasis: "false",
        },
        {
          id: "6542822e410db87ca98e0d4d",
          scoring: "Ratio",
          populations: [
            {
              id: "1a92da52-338a-4ba8-97f5-2e39d6fb1265",
              name: PopulationType.INITIAL_POPULATION,
              definition: "Initial Population",
              associationType: null,
              description: "",
            },
            {
              id: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              name: PopulationType.DENOMINATOR,
              definition: "Denominator",
              associationType: null,
              description: "",
            },
            {
              id: "00ff3893-0435-4b04-90f2-20dba33b3be2",
              name: "denominatorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
            {
              id: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              name: PopulationType.NUMERATOR,
              definition: "Numerator",
              associationType: null,
              description: "",
            },
            {
              id: "b191fdd8-1445-4c04-be9e-89e75e4c0755",
              name: "numeratorExclusion",
              definition: "",
              associationType: null,
              description: "",
            },
          ],
          measureObservations: [
            {
              id: "d900ec36-b995-42e7-9f85-ee0014f5938d",
              definition: "numerObs",
              description: null,
              criteriaReference: "076d12c4-fc19-49f3-8cfe-5a2295e7f5ee",
              aggregateMethod: "Average",
            },
            {
              id: "a92a4954-0434-4e0e-82b7-7f9967c9dd50",
              definition: "denomObs",
              description: null,
              criteriaReference: "ac251f3d-7c6e-4e39-a955-ca263dcf6bba",
              aggregateMethod: "Maximum",
            },
          ],
          groupDescription: "",
          improvementNotation: "",
          rateAggregation: "",
          measureGroupTypes: null,
          scoringUnit: "",
          stratifications: [],
          populationBasis: "false",
        },
      ],
      createdAt: "2023-10-31T12:12:03.888Z",
      createdBy: "nate.moraca@semanticbits.com",
      lastModifiedAt: "2023-11-01T16:55:05.227Z",
      lastModifiedBy: "nate.moraca@semanticbits.com",
      measurementPeriodStart: "2024-01-01T00:00:00.000+00:00",
      measurementPeriodEnd: "2024-12-31T23:59:59.999+00:00",
      supplementalData: [],
      supplementalDataDescription: null,
      riskAdjustments: [],
      riskAdjustmentDescription: null,
      model: "QDM v5.6",
      measureMetaData: {
        steward: null,
        developers: null,
        description: null,
        copyright: null,
        disclaimer: null,
        rationale: null,
        guidance: null,
        clinicalRecommendation: null,
        draft: true,
        references: null,
        endorsements: null,
        riskAdjustment: null,
        definition: null,
        experimental: false,
        transmissionFormat: null,
        supplementalDataElements: null,
      },
      versionId: "3705bb65-eeb4-403a-b2dc-953984887317",
      cmsId: null,
      reviewMetaData: {
        approvalDate: null,
        lastReviewDate: null,
      },
      measureSet: {
        id: "6540ef13854d323018920e00",
        measureSetId: "2b2f52d8-a4f6-47ae-a106-bdc74fc10409",
        owner: "nate.moraca@semanticbits.com",
        acls: null,
      },
      scoring: "Ratio",
      baseConfigurationTypes: ["Outcome"],
      patientBasis: false,
      rateAggregation: null,
      improvementNotation: null,
    } as unknown as Measure,
    patientResults: {
      "6540ef82854d323018920e01": {
        IPP: 4,
        observation_values: [345600, 518400, 6],
        DENOM: 4,
        DENEX: 2,
        NUMER: 1,
        NUMEX: 0,
        episode_results: {
          "6540f0cad9f99000000a50d5": {
            IPP: 1,
            DENOM: 1,
            DENEX: 1,
            NUMER: 0,
            NUMEX: 0,
            observation_values: [],
          },
          "654275f7fb870d00005a0a35": {
            IPP: 1,
            DENOM: 1,
            DENEX: 1,
            NUMER: 0,
            NUMEX: 0,
            observation_values: [],
          },
          "6540f09cd9f99000000a50bf": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 0,
            NUMEX: 0,
            observation_values: [345600],
          },
          "65423e86a168f90000f0d2c0": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [518400, 6],
          },
        },
        clause_results: null,
        patient: "6540f087d9f99000000a50ba",
        measure: "6542b6186376850000906ad2",
        state: "complete",
      },
      "65427991410db87ca98e0d4b": {
        IPP: 4,
        observation_values: [1036800, 12, 1627200, 18, 345600, 518400, 6],
        DENOM: 4,
        DENEX: 0,
        NUMER: 3,
        NUMEX: 0,
        episode_results: {
          "6540f0cad9f99000000a50d5": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [1036800, 12],
          },
          "654275f7fb870d00005a0a35": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [1627200, 18],
          },
          "6540f09cd9f99000000a50bf": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 0,
            NUMEX: 0,
            observation_values: [345600],
          },
          "65423e86a168f90000f0d2c0": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [518400, 6],
          },
        },
        clause_results: null,
        patient: "6540f087d9f99000000a50ba",
        measure: "6542b6186376850000906ad2",
        state: "complete",
      },
      "6542822e410db87ca98e0d4d": {
        IPP: 4,
        observation_values: [1036800, 12, 1627200, 18, 345600, 518400, 6],
        DENOM: 4,
        DENEX: 0,
        NUMER: 3,
        NUMEX: 0,
        episode_results: {
          "6540f0cad9f99000000a50d5": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [1036800, 12],
          },
          "654275f7fb870d00005a0a35": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [1627200, 18],
          },
          "6540f09cd9f99000000a50bf": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 0,
            NUMEX: 0,
            observation_values: [345600],
          },
          "65423e86a168f90000f0d2c0": {
            IPP: 1,
            DENOM: 1,
            DENEX: 0,
            NUMER: 1,
            NUMEX: 0,
            observation_values: [518400, 6],
          },
        },
        clause_results: null,
        patient: "6540f087d9f99000000a50ba",
        measure: "6542b6186376850000906ad2",
        state: "complete",
      },
    },
  };
